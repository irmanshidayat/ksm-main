# =============================================================================
# KSM MAIN - ENVIRONMENT CONFIGURATION
# =============================================================================
#
# INSTRUKSI SETUP:
# ================
#
# DEVELOPMENT (XAMPP Lokal):
# ---------------------------
# 1. Copy file ini ke .env: cp env.example .env
# 2. Gunakan konfigurasi untuk XAMPP lokal:
#    - DB_HOST=localhost
#    - DB_PORT=3306 (XAMPP default)
#    - DB_PASSWORD= (kosong, XAMPP default)
#    - REDIS_URL=redis://localhost:6379/0 (jika Redis diinstall lokal)
# 3. Jalankan aplikasi secara lokal (tidak perlu Docker)
# 4. Aplikasi akan otomatis detect sebagai "local" environment
#
# PRODUCTION (Docker):
# --------------------
# 1. Copy file ini ke .env di ksm-main/: cp env.example .env
# 2. Gunakan konfigurasi untuk Docker:
DB_HOST=mysql-prod (service name di docker-compose)
DB_PORT=3306
DB_PASSWORD=admin123
REDIS_URL=redis://redis-prod:6379/0
# 3. Jalankan: docker-compose up -d
# 4. Aplikasi akan otomatis detect sebagai "docker" environment
#
# AUTO-DETECTION:
# ===============
# Aplikasi akan otomatis mendeteksi environment berdasarkan:
# - Docker: Jika ada file /.dockerenv atau service name di hostname
# - Local: Default jika tidak detect Docker
# - Manual override: Set RUN_MODE=docker atau RUN_MODE=local
#
# =============================================================================

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PENTING: XAMPP dan Docker bisa berjalan bersamaan!
# ====================================================
# Aplikasi akan otomatis mendeteksi environment dan menggunakan konfigurasi yang sesuai.
# Jika XAMPP dan Docker berjalan bersamaan:
# - Aplikasi lokal akan menggunakan XAMPP (localhost:3306)
# - Aplikasi Docker akan menggunakan MySQL container (mysql-prod:3306, external port 3308)

# MySQL Database Configuration
# Development (XAMPP): DB_HOST=localhost, DB_PORT=3306, DB_PASSWORD= (kosong)
# Production (Docker): DB_HOST=mysql-prod, DB_PORT=3306 (internal), external port 3308
# CATATAN: 
# - XAMPP default: localhost:3306 dengan password kosong
# - Jika XAMPP menggunakan port lain, sesuaikan DB_PORT
# - Jika MySQL XAMPP menggunakan password, isi DB_PASSWORD
DB_HOST=localhost
DB_PORT=3306
DB_NAME=KSM_main
DB_USER=root
DB_PASSWORD=

# Database URL untuk SQLAlchemy
# Development (XAMPP): mysql://root:@localhost:3306/KSM_main
# Production (Docker): mysql://root:password@mysql-prod:3306/KSM_main (internal di Docker)
DATABASE_URL=mysql://root:@localhost:3306/KSM_main

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis Configuration
# Development (Lokal): REDIS_URL=redis://localhost:6379/0
# Production (Docker): REDIS_URL=redis://redis-prod:6379/0
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# =============================================================================
# JWT CONFIGURATION
# =============================================================================

# JWT Secret Key (ganti dengan secret key yang aman)
JWT_SECRET_KEY=dev_secret_key_change_in_production
JWT_ACCESS_TOKEN_EXPIRES=3600
JWT_REFRESH_TOKEN_EXPIRES=2592000

# =============================================================================
# API KEYS
# =============================================================================

# OpenAI API Key
OPENAI_API_KEY=your_openai_api_key_here

# OpenRouter API Key (untuk Agent AI)
OPENROUTER_API_KEY=your_openrouter_api_key_here

# Telegram Bot Token
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here

# KSM API Key (untuk komunikasi antar service)
KSM_API_KEY=your_ksm_api_key_here

# Ngrok Auth Token (untuk webhook development)
NGROK_AUTH_TOKEN=your_ngrok_auth_token_here

# =============================================================================
# COMPANY CONFIGURATION
# =============================================================================

# Default Company ID
DEFAULT_COMPANY_ID=PT. Kian Santang Muliatama

# =============================================================================
# FLASK CONFIGURATION
# =============================================================================

# Flask Environment
FLASK_ENV=development
FLASK_DEBUG=1
FLASK_APP=app.py

# Flask Secret Key
SECRET_KEY=flask_secret_key_development

# =============================================================================
# AGENT AI CONFIGURATION
# =============================================================================

# Agent AI Service URL
# Development (Lokal): AGENT_AI_URL=http://localhost:5000
# Production (Docker): AGENT_AI_URL=http://agent-ai-prod:5000
AGENT_AI_URL=http://localhost:5000

# Agent AI Database Configuration (menggunakan database yang sama dengan KSM Main)
Development: Menggunakan XAMPP lokal (localhost:3306)
Production: Menggunakan MySQL container (mysql-prod:3306)
AGENT_AI_DB_HOST=localhost
AGENT_AI_DB_PORT=3306
AGENT_AI_DB_NAME=KSM_main
AGENT_AI_DB_USER=root
AGENT_AI_DB_PASSWORD=

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log Level
LOG_LEVEL=DEBUG

# Log File Paths
LOG_FILE=logs/app.log
ERROR_LOG_FILE=logs/errors.log
PERFORMANCE_LOG_FILE=logs/performance.log

# =============================================================================
# DEVELOPMENT TOOLS
# =============================================================================

# Development Mode
DEVELOPMENT_MODE=true

# Hot Reload
HOT_RELOAD=true

# Debug Mode
DEBUG_MODE=true

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# CORS Origins
# Development: http://localhost:3000,http://localhost:3004,http://localhost:3005,http://localhost:8000,http://localhost:5000
# Production: https://report.ptkiansatang.com
CORS_ORIGINS=http://localhost:3000,http://localhost:3004,http://localhost:3005,http://localhost:8000,http://localhost:5000,https://report.ptkiansatang.com

# =============================================================================
# FILE UPLOAD CONFIGURATION
# =============================================================================

# Upload Directory
UPLOAD_FOLDER=uploads

# Max File Size (dalam bytes)
MAX_CONTENT_LENGTH=16777216

# Allowed Extensions
ALLOWED_EXTENSIONS=txt,pdf,png,jpg,jpeg,gif,doc,docx,xls,xlsx

# =============================================================================
# EMAIL CONFIGURATION (untuk development)
# =============================================================================

# SMTP Configuration
MAIL_SERVER=smtp.gmail.com
MAIL_PORT=587
MAIL_USE_TLS=true
MAIL_USERNAME=your_email@gmail.com
MAIL_PASSWORD=your_app_password

# =============================================================================
# EMAIL DOMAIN ENCRYPTION (untuk enkripsi/dekripsi password SMTP domain)
# =============================================================================
# PENTING:
# - Nilai ini HARUS sama dengan kunci yang digunakan saat password domain disimpan.
# - Jika tidak sama, dekripsi akan gagal dengan pesan: "Gagal mendekripsi password domain".
# - Jika Anda lupa kuncinya, set nilai baru di sini lalu UPDATE ulang password domain
#   melalui API/fitur konfigurasi domain agar dienkripsi ulang dengan kunci baru.
# Format: Kunci Fernet base64 (32-byte), contoh: dP8H...ukSo=
# 
# Cara Generate Encryption Key:
# 1. Buka Python shell: python
# 2. Jalankan: from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())
# 3. Copy hasilnya dan paste di bawah ini
# 
# Atau jalankan di terminal:
# python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# 
# Default key untuk Docker (jika tidak ter-set, akan menggunakan key ini):
# nGLXDhCPmhCx5WugGHstyCkT7RY7P066rE_PnN5Hcqk=
EMAIL_DOMAIN_ENCRYPTION_KEY=nGLXDhCPmhCx5WugGHstyCkT7RY7P066rE_PnN5Hcqk=

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

# Health Check Interval
HEALTH_CHECK_INTERVAL=30

# Performance Monitoring
PERFORMANCE_MONITORING=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# Session Configuration
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Cache Type
CACHE_TYPE=redis

# Cache Default Timeout
CACHE_DEFAULT_TIMEOUT=300

# =============================================================================
# DEVELOPMENT SPECIFIC
# =============================================================================

# Auto Reload
AUTO_RELOAD=true

# Debug Toolbar
DEBUG_TB_ENABLED=true

# Profiler
PROFILER_ENABLED=true

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================

# Test Database
# Development: mysql://root:@localhost:3306/KSM_main_test
# Production: mysql://root:password@mysql-prod:3306/KSM_main_test
TEST_DATABASE_URL=mysql://root:@localhost:3306/KSM_main_test

# Test Mode
TESTING=false

# =============================================================================
# DOCKER PRODUCTION CONFIGURATION
# =============================================================================
#
# CATATAN: Variabel berikut HANYA digunakan saat menjalankan Docker (Production)
# Untuk Development lokal, variabel ini tidak diperlukan
#
# =============================================================================

# Docker Network (Production)
DOCKER_NETWORK=KSM-prod-network

# Container Names (Production)
MYSQL_CONTAINER=KSM-mysql-prod
REDIS_CONTAINER=KSM-redis-prod
BACKEND_CONTAINER=KSM-backend-prod
FRONTEND_CONTAINER=KSM-frontend-prod
AGENT_AI_CONTAINER=KSM-agent-ai-prod
ADMINER_CONTAINER=KSM-adminer-prod

# Grafana Admin Password (untuk monitoring di Production)
GRAFANA_PASSWORD=admin

# =============================================================================
# ADMINER DATABASE MANAGEMENT TOOL CONFIGURATION
# =============================================================================
#
# Adminer adalah tool untuk mengelola database MySQL melalui web interface
# Akses Adminer:
# - Langsung: http://localhost:8083
# - Via Nginx: https://report.ptkiansatang.com/adminer/
#
# Login ke Adminer:
# - System: MySQL
# - Server: mysql-prod (untuk Docker) atau localhost (untuk XAMPP)
# - Username: root (atau DB_USER dari konfigurasi)
# - Password: (DB_PASSWORD dari konfigurasi)
# - Database: KSM_main
#
# CATATAN:
# - Adminer hanya tersedia di Docker Production
# - Untuk Development, gunakan phpMyAdmin atau tool database management lainnya
# - Pastikan Adminer hanya diakses oleh admin yang berwenang
#
# =============================================================================

# Frontend API URL (untuk Docker Production)
# Hanya digunakan saat build frontend di Docker
REACT_APP_API_URL=https://report.ptkiansatang.com/api
REACT_APP_ENVIRONMENT=production

# Redis Password (opsional, untuk Production)
# REDIS_PASSWORD=your_redis_password_here

# =============================================================================
# PORT CONFIGURATION
# =============================================================================

# Service Ports
BACKEND_PORT=8000
FRONTEND_PORT=3000
AGENT_AI_PORT=5000
MYSQL_PORT=3306
REDIS_PORT=6379
NGINX_PORT=80

# Development Tools Ports
PHPMYADMIN_PORT=8080
REDIS_COMMANDER_PORT=8081
ADMINER_PORT=8083

# =============================================================================
# VOLUME CONFIGURATION
# =============================================================================

# Volume Names
MYSQL_VOLUME=mysql_dev_data
REDIS_VOLUME=redis_dev_data
BACKEND_LOGS_VOLUME=KSM_backend_dev_logs
# BACKEND_CHROMADB_VOLUME=KSM_backend_dev_chromadb  # Removed: using Qdrant instead
BACKEND_RAG_DOCUMENTS_VOLUME=KSM_backend_dev_rag_documents
AGENT_AI_LOGS_VOLUME=agent_ai_dev_logs
# AGENT_AI_CHROMADB_VOLUME=agent_ai_dev_chromadb  # Removed: using Qdrant instead