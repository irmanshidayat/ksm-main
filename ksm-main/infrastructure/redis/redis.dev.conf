# KSM Main Redis Development Configuration
# Optimized untuk development dengan monitoring dan debugging

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# Bind ke semua interface untuk development
bind 0.0.0.0

# Port Redis
port 6379

# Timeout untuk client connections
timeout 300

# TCP keepalive
tcp-keepalive 60

# =============================================================================
# GENERAL CONFIGURATION
# =============================================================================

# Daemonize (tidak digunakan dalam Docker)
daemonize no

# PID file
pidfile /var/run/redis.pid

# Log level untuk development
loglevel debug

# Log file
# Untuk menghindari error permission di dalam container, log diarahkan ke stdout
logfile ""

# Database number
databases 16

# =============================================================================
# MEMORY CONFIGURATION
# =============================================================================

# Max memory untuk development (512MB)
maxmemory 512mb

# Memory policy
maxmemory-policy allkeys-lru

# =============================================================================
# PERSISTENCE CONFIGURATION
# =============================================================================

# Save snapshots
save 900 1
save 300 10
save 60 10000

# RDB compression
rdbcompression yes

# RDB checksum
rdbchecksum yes

# RDB filename
dbfilename dump.rdb

# RDB directory
dir /data

# AOF (Append Only File) untuk development
appendonly yes
appendfilename "appendonly.aof"

# AOF sync policy
appendfsync everysec

# AOF rewrite
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# =============================================================================
# REPLICATION CONFIGURATION
# =============================================================================

# Master password (tidak digunakan untuk development)
# masterauth

# Slave password (tidak digunakan untuk development)
# requirepass

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Disable protected mode untuk development
protected-mode no

# Disable dangerous commands untuk development
# rename-command FLUSHDB ""
# rename-command FLUSHALL ""
# rename-command KEYS ""
# rename-command CONFIG ""

# =============================================================================
# CLIENT CONFIGURATION
# =============================================================================

# Max clients
maxclients 1000

# Client output buffer limits
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

# Slow log
slowlog-log-slower-than 10000
slowlog-max-len 128

# Latency monitoring
latency-monitor-threshold 100

# =============================================================================
# ADVANCED CONFIGURATION
# =============================================================================

# Hash configuration
hash-max-ziplist-entries 512
hash-max-ziplist-value 64

# List configuration
list-max-ziplist-size -2
list-compress-depth 0

# Set configuration
set-max-intset-entries 512

# Sorted set configuration
zset-max-ziplist-entries 128
zset-max-ziplist-value 64

# HyperLogLog configuration
hll-sparse-max-bytes 3000

# Streams configuration
stream-node-max-bytes 4096
stream-node-max-entries 100

# =============================================================================
# DEVELOPMENT SPECIFIC CONFIGURATION
# =============================================================================

# Enable keyspace notifications untuk development
notify-keyspace-events "Ex"

# Enable command logging untuk development
# log-commands

# Enable client connections logging
# log-clients

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================

# TCP backlog
tcp-backlog 511

# Unix socket (tidak digunakan untuk development)
# unixsocket /tmp/redis.sock
# unixsocketperm 700

# =============================================================================
# DEBUGGING CONFIGURATION
# =============================================================================

# Enable debug mode
# debug-mode yes

# Enable verbose logging
# verbose-logging yes

# =============================================================================
# DEVELOPMENT TOOLS CONFIGURATION
# =============================================================================

# Enable Redis Commander compatibility
# redis-commander compatible

# Enable RedisInsight compatibility
# redisinsight compatible

# =============================================================================
# CUSTOM CONFIGURATION
# =============================================================================

# Custom configuration untuk development
# development-mode yes
# hot-reload yes
# debug-commands yes
